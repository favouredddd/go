{"version":3,"sources":["webpack:///./src/addTips/util/imgToString.vue?3156","webpack:///src/addTips/util/imgToString.vue","webpack:///./src/addTips/util/imgToString.vue?8d07","webpack:///./src/addTips/util/imgToString.vue","webpack:///./src/addTips/util/imgToString.vue?6358"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","describe","directives","name","rawName","value","expression","jsCode","staticStyle","on","copy","ref","attrs","domProps","originCode","staticRenderFns","data","mounted","$nextTick","methods","document","execCommand","$refs","textArea","select","component"],"mappings":"iJAAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,WAAW,CAACF,EAAG,MAAM,CAACE,YAAY,UAAU,CAACN,EAAIO,GAAG,UAAUH,EAAG,MAAM,CAACE,YAAY,aAAa,CAACN,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIS,aAAaL,EAAG,MAAM,CAACE,YAAY,QAAQ,CAACF,EAAG,MAAM,CAACA,EAAG,MAAM,CAACE,YAAY,WAAW,CAACN,EAAIO,GAAG,UAAUH,EAAG,OAAO,CAACM,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYC,MAAOb,EAAU,OAAEc,WAAW,WAAWR,YAAY,mBAAmB,CAACN,EAAIO,GAAGP,EAAIQ,GAAGR,EAAIe,WAAWX,EAAG,MAAM,CAACE,YAAY,UAAUU,YAAY,CAAC,SAAW,aAAa,CAAChB,EAAIO,GAAG,gBAAgBH,EAAG,MAAM,CAACE,YAAY,OAAOW,GAAG,CAAC,MAAQjB,EAAIkB,OAAO,CAAClB,EAAIO,GAAG,YAAYH,EAAG,OAAO,CAACe,IAAI,WAAWb,YAAY,WAAWc,MAAM,CAAC,WAAa,QAAQC,SAAS,CAAC,UAAYrB,EAAIQ,GAAGR,EAAIsB,sBACnwBC,EAAkB,GCuBtB,GACEC,KADF,WAEI,MAAO,CACLf,SAAU,uBACVM,OAAN,sPAWMO,WAAY,wzHAyJhBG,QAxKF,WAwKA,WACIxB,KAAKyB,WAAU,WACb,EAAN,mEAGEC,QAAS,CACPT,KADJ,WAEMU,SAASC,YAAY,QAAQ,EAAO5B,KAAK6B,MAAMC,SAASC,aCvMsS,I,wBCQhWC,EAAY,eACd,EACAlC,EACAwB,GACA,EACA,KACA,KACA,MAIa,aAAAU,E,2CCnBf,0BAAsiB,EAAG","file":"js/chunk-aba3efe2.7c523a7a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"content\"},[_c('div',{staticClass:\"header\"},[_vm._v(\"图片缓存\")]),_c('div',{staticClass:\"introduce\"},[_vm._v(_vm._s(_vm.describe))]),_c('div',{staticClass:\"code\"},[_c('div',[_c('div',{staticClass:\"jsTitle\"},[_vm._v(\"js代码\")]),_c('code',{directives:[{name:\"helight\",rawName:\"v-helight\",value:(_vm.jsCode),expression:\"jsCode\"}],staticClass:\"hljs javascript\"},[_vm._v(_vm._s(_vm.jsCode))]),_c('div',{staticClass:\"jsTitle\",staticStyle:{\"position\":\"relative\"}},[_vm._v(\"源码\\n        \"),_c('div',{staticClass:\"copy\",on:{\"click\":_vm.copy}},[_vm._v(\"一键复制\")])]),_c('code',{ref:\"textArea\",staticClass:\"codeArea\",attrs:{\"autoHeight\":\"true\"},domProps:{\"innerHTML\":_vm._s(_vm.originCode)}})])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"content\">\n    <div class=\"header\">图片缓存</div>\n    <div class=\"introduce\">{{describe}}</div>\n    <div class=\"code\">\n      <div>\n        <div class=\"jsTitle\">js代码</div>\n        <code v-helight=\"jsCode\" class=\"hljs javascript\">{{jsCode}}</code>\n        <div class=\"jsTitle\"\n             style=\"position:relative\">源码\n          <div class=\"copy\"\n               @click=\"copy\">一键复制</div>\n        </div>\n        <code \n              v-html=\"originCode\"\n              class=\"codeArea\"\n              autoHeight=\"true\"\n              ref=\"textArea\">\n        </code>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nexport default {\n  data () {\n    return {\n      describe: `这是一款普通图片转换为字符串缓存的工具包`,\n      jsCode:\n        `  import {fileToString} from 'xxxx';\n  //type 有base64(fileReader),canvas,url\n  //需要注意的是url和base64 后台需要返回blob对象,canvas要设置图片跨域支持\n  const  config={\n    url:'',\n    type:'',\n    attempt:number\n  }\n  new fileToString(config)\n  .then(r=>{})`,\n      originCode: `class Ajax {\n  constructor() {\n    let me = this\n  }\n  static init (config) {\n    let me = this\n    config.type = config.type === undefined ? 'get' : config.type\n    config.count = config.tempt;\n    switch (config.type) {\n      case 'get':\n        return me.getRequest(config)\n      case 'post':\n        return me.postRequest(config)\n    }\n  }\n  static getRequest (config) {\n    let params = config.params || {}\n    config.count = config.count === undefined ? 1 : config.count\n    let url = Object.keys(params)\n      .map(i => {\n        return i + '=' + params[i]\n      })\n      .join('&')\n    if (config.url.endsWith('?')) {\n      url = config.url + url\n    } else {\n      url = config.url + '?' + url\n    }\n    let xml = new XMLHttpRequest()\n    return new Promise((resolve, reject) => {\n      xml.onload = () => {\n        if (xml.status !== 500) {\n          resolve(xml.response)\n        } else {\n          config.count -= 1;\n          if (count > 0) {\n            return this.getRequest(config)\n          }\n        }\n      }\n      xml.onerror = () => {\n        config.count -= 1;\n        if (count > 0) {\n          return this.getRequest(config)\n        }\n      }\n      xml.open('get', url)\n      xml.responseType = 'blob'\n      xml.send(null)\n    })\n  }\n  static postRequest (config) {\n    let file = new FormData()\n    let xml = new XMLHttpRequest()\n    let progress = config.progress || function (e) { }\n    xml.onload = () => {\n      if (xml.status === 200) {\n        config.callback(xml.responseText)\n      }\n    }\n    xml.upload.onprogress = progress\n    if (config.params.constructor === Array) {\n      config.params.forEach((i, index) => {\n        file.append('file' + index, i.file)\n      })\n    } else {\n      Object.keys(config.params).forEach(i => {\n        file.append(i, config.params[i])\n      })\n    }\n    xml.open('post', config.url)\n    xml.send(file)\n  }\n}\nclass fileToString {\n  constructor(config) {\n    this.src = config.src;\n    this.attempt = config.attempt\n    switch (config.type) {\n      case 'url':\n        return this.createUrl();\n      case 'base64':\n        return this.createBase64();\n      case 'canvas':\n        return this.createCanavs();\n    }\n  }\n  createBase64 () {\n    return Ajax.init({ url: this.src, attempt: this.attempt }).then(file => {\n      return this.doCreateBase64(file)\n    })\n  }\n  createCanavs () {\n    return this.doCreateCanavs().then(img => {\n      if (!img)\n        return \"\"\n      let canvas = document.createElement(\"canvas\");\n      let ctx=canvas.getContext(\"2d\")\n      canvas.width = img.width;\n      canvas.height = img.height;\n      ctx.drawImage(img, 0,0);\n      return canvas.toDataURL()\n    })\n  }\n  doCreateCanavs () {\n    return new Promise((resolve, reject) => {\n      let img = new Image();\n      img.crossOrigin=\"anonymous\"\n      img.onload = () => {\n        resolve(img)\n      }\n      img.onerror = () => {\n        this.attempt-=1;\n        if (this.attempt > 0) {\n          return reject(this.createCanavs());\n        } else {\n          return Promise.resolve();\n        }\n      }\n      img.src=this.src\n    }).then(r => {\n      return r\n    }, r => {\n      return r\n    })\n  }\n  createUrl () {\n    return Ajax.init({ url: this.src, attempt: this.attempt })\n      .then((file) => {\n        return Promise.resolve(window.URL.createObjectURL(file))\n      });\n  }\n  doCreateBase64 (file) {\n    return new Promise((resolve, reject) => {\n      let me = this\n      let fileReader = new FileReader()\n      fileReader.onload = e => {\n        resolve(e.target.result)\n      }\n      fileReader.readAsDataURL(file)\n    })\n  }\n}\nexport default {fileToString:fileToString}\n/*const  config={\n  url:'',\n  type:'',\n  attempt:number\n}\nnew fileToString(config)\n.then(r=>{})*/`,\n    }\n  },\n  mounted () {\n    this.$nextTick(() => {\n      this.$refs.textArea.style.height = this.$refs.textArea.scrollHeight + 'px'\n    })\n  },\n  methods: {\n    copy () {\n      document.execCommand('copy', false, this.$refs.textArea.select());\n    },\n  }\n}\n</script>\n<style lang=\"less\">\n.boxShadow {\n  box-shadow: 2px 2px 10px rgba(0, 0, 0, 0.1);\n}\n.content {\n  padding: 0.5rem;\n  .header {\n    font-size: 1rem;\n    color: #d08770;\n    text-indent: 0.5rem;\n  }\n  > div {\n    margin-bottom: 0.4rem;\n    border-radius: 5px;\n  }\n  .copy {\n    float: right;\n    margin-right: 1rem;\n    text-indent: 0;\n    background-color: #0085ff;\n    padding: 0.2rem 0.3rem;\n    font-size: 12px;\n    color: #fff;\n    border-radius: 5px;\n    .boxShadow;\n  }\n  .eventTitle {\n    font-size: 0.6rem;\n  }\n  .swipeWrap {\n    height: 5rem;\n    background-image: linear-gradient(90deg, #0af, #0085ff);\n  }\n  .codeArea {\n    width: 100%;\n    outline: none;\n    display: block;\n    .boxShadow;\n    background-color: #2b303b;\n    border: 1px solid #cecece;\n    font-weight: 400;\n    color: #fff;\n  }\n}\n</style>","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./imgToString.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./imgToString.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./imgToString.vue?vue&type=template&id=2d1a6e6b&\"\nimport script from \"./imgToString.vue?vue&type=script&lang=js&\"\nexport * from \"./imgToString.vue?vue&type=script&lang=js&\"\nimport style0 from \"./imgToString.vue?vue&type=style&index=0&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./imgToString.vue?vue&type=style&index=0&lang=less&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../node_modules/css-loader/index.js??ref--10-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./imgToString.vue?vue&type=style&index=0&lang=less&\""],"sourceRoot":""}