(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d14ed7c0"],{"15e1":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content"},[n("div",{staticClass:"header"},[e._v("swipe指令")]),n("div",{staticClass:"introduce"},[e._v(e._s(e.describe))]),n("div",{staticClass:"eventTitle"},[e._v("手势区域")]),n("div",{directives:[{name:"swipe",rawName:"v-swipe",value:e.event,expression:"event"}],staticClass:"swipeWrap"}),n("div",{staticClass:"code"},[n("div",[n("div",{staticClass:"title"},[e._v("html代码")]),n("code",{directives:[{name:"helight",rawName:"v-helight",value:e.code,expression:"code"}],staticClass:"hljs javascript"},[e._v(e._s(e.code))]),n("div",{staticClass:"jsTitle"},[e._v("js代码")]),n("code",{directives:[{name:"helight",rawName:"v-helight",value:e.jsCode,expression:"jsCode"}],staticClass:"hljs javascript"},[e._v(e._s(e.jsCode))]),n("div",{staticClass:"jsTitle",staticStyle:{position:"relative"}},[e._v("源码\n        "),n("div",{staticClass:"copy",on:{click:e.copy}},[e._v("一键复制")])]),n("code",{ref:"textArea",staticClass:"codeArea",attrs:{autoHeight:"true"},domProps:{innerHTML:e._s(e.originCode)}})])])])},i=[],d={data:function(){return{describe:"这是一款简单手势指令,可以上下左右滑动,并添加相对应的事件",event:{left:this.swipeEvent("left"),right:this.swipeEvent("right"),up:this.swipeEvent("up"),down:this.swipeEvent("down")},code:'\n      <div class="swipeWrap"\n          v-swipe="event">\n      </div>',jsCode:"\n      event:\n      {\n        left: this.swipeLeft,\n        right: this.swipeRight,\n        up: this.swipeUp,\n        down: this.swipeDown\n      }",originCode:"class Swipe {\n  constructor (dom, event, vnode) {\n    const me = dom\n    me.record = {\n      time: [],\n      site: [],\n      old: {}\n    }\n    me.$model = vnode.context\n    me.event = event\n    this.init(dom)\n  }\n  init (dom) {\n    this.addTouchEvent(dom)\n  }\n  addTouchEvent (dom) {\n    const me = dom\n    let touchEvent = ['touchstart', 'touchmove', 'touchend'].map(i => {\n      me.addEventListener(i, this[i], false)\n      return [i, this[i]]\n    })\n    dom.$touchEvent = touchEvent\n  }\n  touchstart (e) {\n    let evtObj = this\n    let tch = e.touches[0]\n    let t = Date.now()\n    evtObj.extParams = {\n      swipe: {\n        oldTime: [t, t],\n        speedLoc: [\n          { x: tch.pageX, y: tch.pageY },\n          { x: tch.pageX, y: tch.pageY }\n        ],\n        oldLoc: { x: tch.pageX, y: tch.pageY }\n      }\n    }\n  }\n  touchmove (e) {\n    let evtObj = this\n    let nt = Date.now()\n    let tch = e.touches[0]\n    let mv = evtObj.extParams['swipe']\n    // 50ms记录一次\n    if (nt - mv.oldTime[0] > 50) {\n      mv.speedLoc[0] = { x: mv.speedLoc[1].x, y: mv.speedLoc[1].y }\n      mv.speedLoc[1] = { x: tch.pageX, y: tch.pageY }\n      mv.oldTime[0] = mv.oldTime[1]\n      mv.oldTime[1] = nt\n    }\n    mv.oldLoc = { x: tch.pageX, y: tch.pageY }\n  }\n  touchend (e) {\n    let evtObj = this\n    let mv = evtObj.extParams['swipe']\n    let nt = Date.now()\n\n    // 取值序号 0 或 1，默认1，如果释放时间与上次事件太短，则取0\n    let ind = nt - mv.oldTime[1] < 30 ? 0 : 1\n    let dx = mv.oldLoc.x - mv.speedLoc[ind].x\n    let dy = mv.oldLoc.y - mv.speedLoc[ind].y\n    let s = Math.sqrt(dx * dx + dy * dy)\n    let dt = nt - mv.oldTime[ind]\n    // 超过300ms 不执行事件\n    if (dt > 300 || s < 10) {\n      return\n    }\n    let v0 = s / dt\n    // 速度>0.1,触发swipe事件\n    if (v0 > 0.05) {\n      let sname = ''\n      if (dx < 0 && Math.abs(dy / dx) < 1) {\n        e.v0 = v0 // 添加附加参数到e\n        sname = 'left'\n      }\n      if (dx > 0 && Math.abs(dy / dx) < 1) {\n        e.v0 = v0\n        sname = 'right'\n      }\n      if (dy > 0 && Math.abs(dx / dy) < 1) {\n        e.v0 = v0\n        sname = 'down'\n      }\n      if (dy < 0 && Math.abs(dx / dy) < 1) {\n        e.v0 = v0\n        sname = 'up'\n      }\n      evtObj.event[sname].call(evtObj.$model)\n    }\n  }\n}\nexport default {\n  bind (el, binding, vnode) {\n    el.$swipe = new Swipe(el, binding.value, vnode)\n  },\n  unbind (el, binding) {\n    el.$touchEvent.forEach(function (event) {\n      el.removeEventListener(event[0], event[1])\n    }, this)\n    el.$swipe = null\n  }\n}\n"}},mounted:function(){var e=this;this.$nextTick((function(){e.$refs.textArea.style.height=e.$refs.textArea.scrollHeight+"px"}))},methods:{copy:function(){document.execCommand("copy",!1,this.$refs.textArea.select())},swipeEvent:function(e){return function(){alert(e)}}}},o=d,a=(n("c0a4"),n("2877")),c=Object(a["a"])(o,s,i,!1,null,null,null);t["default"]=c.exports},a5f9:function(e,t,n){},c0a4:function(e,t,n){"use strict";var s=n("a5f9"),i=n.n(s);i.a}}]);
//# sourceMappingURL=chunk-d14ed7c0.b275be15.js.map